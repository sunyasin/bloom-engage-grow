
# План исправления Edge Function get-telegram-id

## Обнаруженная проблема

При тестировании webhook бота обнаружена ошибка: функция не может найти профиль, хотя он существует в базе данных.

**Причина:** В запросе к таблице `profiles` используется колонка `first_name`, которой не существует. Правильное название колонки — `real_name`.

**Код с ошибкой (строка 45):**
```typescript
.select('id, email, first_name')  // ❌ first_name не существует
```

## Изменения

### Файл: `supabase/functions/get-telegram-id/index.ts`

**Строка 45:** Заменить `first_name` на `real_name`:
```typescript
.select('id, email, real_name')  // ✅ Правильно
```

## Результат

После исправления:
- Webhook будет корректно находить профиль пользователя
- Telegram ID будет успешно привязываться к профилю
- Пользователь получит подтверждение в боте о привязке

## Техническая информация

- Таблица `profiles` содержит колонку `real_name`, не `first_name`
- Колонка `telegram_first_name` используется для хранения имени из Telegram (это уже работает)
- Профиль `23805f2c-1230-4556-9175-2d34c84212bc` существует и готов к привязке

